---
title: "Calisi Review"
output: md_document
---

# Sex-biased transcriptomic response of the reproductive axis to stress

This venn diagram is from [this paper](https://www.sciencedirect.com/science/article/pii/S0018506X17302696?via%3Dihub)

![](venn-original.png)

```{r setup, message = F, echo = T}
library(ggplot2)
library(dplyr)
library(cowplot)
#library(ggrepel)

knitr::opts_chunk$set(fig.path = './', echo = T, message = F)
```

```{r venn-alt}
venn <- read.csv("venn.csv")

venn$tissue <- factor(venn$tissue, levels = c("hyp", "pit", "gon"))
venn$sex <- factor(venn$sex, levels = c("female", "both", "male"))
levels(venn$direction) <-  c("down", "up")
levels(venn$tissue) <-  c("hypothalamus", "pituitary", "gonads")


venn$directionsex <- as.factor(paste(venn$direction, venn$sex, sep = "\n"))


mycolors <- c("down\nboth" = "#838383",
                "down\nfemale" = "#19A400", 
                 "down\nmale"  = "#516DFF",
                 "up\nboth"  = "#D9D9D9",
                 "up\nfemale"  = "#7EDC00",
                 "up\nmale" = "#8AC5F9")  


venn$directionsex <- factor(venn$directionsex, levels = c("down\nfemale", 
                                                          "down\nmale",
                                                          "down\nboth",
                                                          "up\nboth",
                                                          "up\nmale",
                                                            "up\nfemale"))

p2 <- ggplot(data=venn, aes(x=tissue, y = count,  fill = reorder(directionsex, desc(directionsex)))) + 
  geom_bar(stat="identity") +
  labs(y = "total DEGs", x = "direction * sex") +
  scale_fill_manual(values = mycolors) +
  #geom_text_repel(position = "stack", aes(x=direction, y = count,  label = count ))
  #facet_wrap(~tissue) +
  guides(fill = guide_legend(nrow = 2))  +
  theme_minimal() +
    theme(legend.position = "bottom",
          legend.title = element_blank())
p2 
```


```{r calisi-original-alt}
p1 <- ggdraw() + draw_image("venn-original.png")
plot_grid(p1, p2, nrow = 1, rel_widths = c(0.6, 0.4))
```

